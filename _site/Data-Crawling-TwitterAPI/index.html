<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Data Crawling with Twitter API - Jae’s Blog</title>
<meta name="description" content="Small project of data crawling.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Jae's Blog">
<meta property="og:title" content="Data Crawling with Twitter API">
<meta property="og:url" content="http://localhost:4000/Data-Crawling-TwitterAPI/">


  <meta property="og:description" content="Small project of data crawling.">







  <meta property="article:published_time" content="2020-08-09T00:00:00+01:00">





  

  


<link rel="canonical" href="http://localhost:4000/Data-Crawling-TwitterAPI/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Jae H. Choi",
      "url": "http://localhost:4000",
      "sameAs": ["https://www.linkedin.com/in/jaechoi2357/"]
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Jae's Blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>
    </script>
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/mush.jpeg" alt=""></a>
        
        <a class="site-title" href="/">Jae's Blog</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Portfolios/Concepts</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Personal Interests</a>
            </li><li class="masthead__menu-item">
              <a href="/cheatsheets/introduction/" >Cheatsheets</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/profile.jpeg" alt="Jae H. Choi" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Jae H. Choi</h3>
    
    
      <p class="author__bio" itemprop="description">
        Yesterday is history, tomorrow is a mystery, but today is a gift. That's why it's called the present.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Tempe, AZ</span>
        </li>
      

      
        
          
            <li><a href="mailto:jaehyuk0325@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/jaechoi2357/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://devpost.com/jaehyuk0325?ref_content=user-portfolio&ref_feature=portfolio&ref_medium=global-nav" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> DevPost</a></li>
          
        
          
        
          
        
          
            <li><a href="https://github.com/pnut2357" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Data Crawling with Twitter API">
    <meta itemprop="description" content="API / Web / Data Crawling / Twitter / Sentiment Analysis / NLP">
    <meta itemprop="datePublished" content="August 09, 2020">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Data Crawling with Twitter API
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  16 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#get-consumer-key-api-key-and-access-key-access-token">Get Consumer Key (API key) and Access Key (Access token)</a></li>
  <li><a href="#open-source-libraries">Open Source Libraries</a></li>
  <li><a href="#practice">Practice</a>
    <ul>
      <li><a href="#save-consumer-key-and-access-key">Save Consumer Key and Access Key</a></li>
    </ul>
  </li>
  <li><a href="#practice1-world-sentiment-comparison-superman-vs-batman">Practice1: World Sentiment Comparison (Superman vs. Batman)</a>
    <ul>
      <li><a href="#importing">Importing</a></li>
      <li><a href="#streaming-and-functions-defined-get-clean-classify-and-measure">Streaming and Functions Defined: get, clean, classify, and measure.</a></li>
      <li><a href="#main">Main</a></li>
    </ul>
  </li>
  <li><a href="#practice2-twitter-streaming-and-visualizing-trump">Practice2: Twitter Streaming and Visualizing (Trump)</a>
    <ul>
      <li><a href="#importing-1">Importing</a></li>
      <li><a href="#streaming-and-saving-live-streaming-data">Streaming and Saving Live Streaming Data</a></li>
      <li><a href="#loading-and-cleaning-the-data">Loading and Cleaning the Data</a></li>
    </ul>
  </li>
</ul>
            </nav>
          </aside>
        
        <h1 id="introduction">Introduction</h1>
<p>In the earlier post, I briefly introduced about how API and web work. In this post, let me talk about the practical usage of API: data crawling using Twitter API.</p>

<h1 id="get-consumer-key-api-key-and-access-key-access-token">Get Consumer Key (API key) and Access Key (Access token)</h1>

<p>If you want access to Twitter’s APIs, you should create a twitter account (if you don’t have one) and apply for a developer account using the new developer portal at <a href="https://developer.twitter.com/en">developer.twitter.com</a>.</p>

<p>If you want a help for steps in order to prevent to be banned, I recommend this <a href="https://www.youtube.com/watch?v=vlvtqp44xoQ">youtube instruction</a></p>

<p>Then, you should see Apps when you place your cursor on the account (right top corner in the figure shown below).</p>

<p><img src="/assets/images/Data-Crawling-TwitterAPI/tw_webpage.png" alt="tw_webpage" height="800px" width="600px" /><br />
| Fig1. Twitter Developer Portal|</p>

<p>From your Twitter Apps page, click <code class="language-plaintext highlighter-rouge">+ create App</code> and you are ready to go.</p>

<p><img src="/assets/images/Data-Crawling-TwitterAPI/tw_acc.png" alt="tw_acc" height="800px" width="400px" /><br />
| Fig2. Twitter Developer Apps Page|</p>

<h1 id="open-source-libraries">Open Source Libraries</h1>
<p>The following libararies are open-source Python libraries for accessing Twitter API. I personally started with <code class="language-plaintext highlighter-rouge">tweepy</code>.</p>
<ul>
  <li>python-twitter by the Python-Twitter Developers</li>
  <li>tweepy by the tweepy Developers</li>
  <li>twitter by the Python Twitter Tools developer team</li>
  <li>TwitterSearch by @ckoepp</li>
  <li>twython by @ryanmcgrath and @mikehelmick</li>
  <li>TwitterAPI by @geduldig</li>
</ul>

<blockquote>
  <p><strong>NOTE</strong> API and Libraries are different; while API is defined to interact softwares, library is a chunk of running codes for development reusability. So, an API can be embedded in a library.</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Library</th>
      <th style="text-align: center">API</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">A reusable chunk of codes</td>
      <td style="text-align: center">interaction between running codes</td>
    </tr>
    <tr>
      <td style="text-align: center">not an API by itself</td>
      <td style="text-align: center">can be made of several libraries</td>
    </tr>
  </tbody>
</table>

<h1 id="practice">Practice</h1>
<h2 id="save-consumer-key-and-access-key">Save Consumer Key and Access Key</h2>

<p>The following code is secrete.py file that I separately saved Consumer Key and Access Key.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># API key == consumer_key
</span><span class="n">consumer_key</span> <span class="o">=</span> <span class="s">"???"</span>
<span class="c1"># API secret key == consumer_secrets
</span><span class="n">consumer_secret</span> <span class="o">=</span>  <span class="s">"???"</span>
<span class="c1"># Access token == access_key
</span><span class="n">access_key</span> <span class="o">=</span> <span class="s">"???"</span>
<span class="c1"># Access token secret == access_secret
</span><span class="n">access_secret</span> <span class="o">=</span> <span class="s">"???"</span>
</code></pre></div></div>

<h1 id="practice1-world-sentiment-comparison-superman-vs-batman">Practice1: World Sentiment Comparison (Superman vs. Batman)</h1>

<p>Practice1 is to see how live twitters think about two keywords. The program captures the real-time tweets related to two keywords that you can set up. In this time, let’s compare Superman with Batman.</p>

<p><img src="/assets/images/Data-Crawling-TwitterAPI/sup_bat.png" alt="sup_bat" height="800px" width="200px" /></p>

<h2 id="importing">Importing</h2>
<p>First, I imported the necessary libraries and set the credentials (Consumer Key and Access Key).</p>
<blockquote>
  <p>consumer_key (variable) is set as API key and access_key (variable) is set as Access token.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tweepy</span>
<span class="kn">from</span> <span class="nn">textblob</span> <span class="kn">import</span> <span class="n">TextBlob</span>
<span class="kn">import</span> <span class="nn">preprocessor</span> <span class="k">as</span> <span class="n">prep</span>
<span class="kn">import</span> <span class="nn">statistics</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">secrets</span> <span class="kn">import</span> <span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_secret</span><span class="p">,</span> <span class="n">access_key</span><span class="p">,</span> <span class="n">access_secret</span>
<span class="c1"># Authentication:
</span><span class="n">auth</span><span class="o">=</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">AppAuthHandler</span><span class="p">(</span><span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_secret</span><span class="p">)</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">API</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>
</code></pre></div></div>
<h2 id="streaming-and-functions-defined-get-clean-classify-and-measure">Streaming and Functions Defined: get, clean, classify, and measure.</h2>

<p><code class="language-plaintext highlighter-rouge">get_tweets()</code> is to stream the 10 live tweets related to the ‘keyword’ you will set, <code class="language-plaintext highlighter-rouge">clean_tweets()</code> is to clean the parsed tweets that contain non-alphabetical characters, <code class="language-plaintext highlighter-rouge">get_sentiment()</code> is to measure and return the score of argument ‘tweets’, and <code class="language-plaintext highlighter-rouge">generate_average_sentiment_score()</code> is to generate the average scores of two keywords for comparison. The Cursor object helps you to get access to Twitter APIs.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_tweets</span><span class="p">(</span><span class="n">keyword</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">all_tweets</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">Cursor</span><span class="p">(</span><span class="n">api</span><span class="p">.</span><span class="n">search</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">keyword</span><span class="p">,</span> <span class="n">tweet_mode</span><span class="o">=</span><span class="s">'extended'</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s">'en'</span><span class="p">).</span><span class="n">items</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">all_tweets</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tweet</span><span class="p">.</span><span class="n">full_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_tweets</span>

<span class="k">def</span> <span class="nf">clean_tweets</span><span class="p">(</span><span class="n">all_tweets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">tweets_clean</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">all_tweets</span><span class="p">:</span>
        <span class="n">tweets_clean</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">prep</span><span class="p">.</span><span class="n">clean</span><span class="p">(</span><span class="n">tweet</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tweets_clean</span>

<span class="k">def</span> <span class="nf">get_sentiment</span><span class="p">(</span><span class="n">all_tweets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="n">sentiment_scores</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">all_tweets</span><span class="p">:</span>
        <span class="n">blob</span> <span class="o">=</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>
        <span class="n">sentiment_scores</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">blob</span><span class="p">.</span><span class="n">sentiment</span><span class="p">.</span><span class="n">polarity</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sentiment_scores</span>

<span class="k">def</span> <span class="nf">generate_average_sentiment_score</span><span class="p">(</span><span class="n">keyword</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">tweets</span> <span class="o">=</span> <span class="n">get_tweets</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span>
    <span class="n">tweets_clean</span> <span class="o">=</span> <span class="n">clean_tweets</span><span class="p">(</span><span class="n">tweets</span><span class="p">)</span>
    <span class="n">sentiment_scores</span> <span class="o">=</span> <span class="n">get_sentiment</span><span class="p">(</span><span class="n">tweets_clean</span><span class="p">)</span>
    <span class="n">average_score</span> <span class="o">=</span> <span class="n">statistics</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sentiment_scores</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">average_score</span>
</code></pre></div></div>

<h2 id="main">Main</h2>

<p>The main started with asking two keywords to check which keyword the live twitters prefer. I inserted ‘superman’ and ‘batman’ to compare.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'What does the world prefer?'</span><span class="p">)</span>
    <span class="n">first_thing</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'...or...'</span><span class="p">)</span>
    <span class="n">second_thing</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="n">first_score</span> <span class="o">=</span> <span class="n">generate_average_sentiment_score</span><span class="p">(</span><span class="n">first_thing</span><span class="p">)</span>
    <span class="n">second_score</span> <span class="o">=</span> <span class="n">generate_average_sentiment_score</span><span class="p">(</span><span class="n">second_thing</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">first_score</span> <span class="o">&gt;</span> <span class="n">second_score</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'the humanity prefers </span><span class="si">{</span><span class="n">first_thing</span><span class="si">}</span><span class="s"> over </span><span class="si">{</span><span class="n">second_thing</span><span class="si">}</span><span class="s">!'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'the humanity prefers </span><span class="si">{</span><span class="n">second_thing</span><span class="si">}</span><span class="s"> over </span><span class="si">{</span><span class="n">first_thing</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

</code></pre></div></div>
<p>As the result shows, the live twitters, at the moment, prefer batman to superman.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>What does the world prefer?

 superman

...or...

 batman

the humanity prefers batman over superman
</code></pre></div></div>

<p>Let’s go further how accurately TextBlob classifies positive, negative, and neutral on each text. That is called Sentiment Analysis. using the function ‘get_tweets()’, I saved all the live tweets in variable ‘tweets’.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tweets</span> <span class="o">=</span> <span class="n">get_tweets</span><span class="p">(</span><span class="s">'superman'</span><span class="p">)</span>
<span class="n">tweets</span>
</code></pre></div></div>
<p>The following tweets shows the live tweets on the first keyword ‘superman’ at that moment.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['RT @CristianT__T: The Best #superman 🧤🧤 https://t.co/UmXiDDQ4c4',
 '@DanSlott WATCHMEN\nPERSEPOLIS\nMAUS\nBATMAN YEAR ONE\nX-MEN GOD LOVES, MAN KILLS\nSECRET WARS\nIDENTITY CRISIS\nBATMAN BLACK MIRROR\nSPIDER-MAN SAGA OF THE ALIEN COSTUME\nALL-STAR SUPERMAN',
 '@FeathersandFoes I chose Superman on purpose. His stories are usually uplifting and pretty positive. If you get a chance, the first story arc post Infinite Crisis (one year later) is amazing.',
 '@DanSlott Dark Pheonix\nAll Star Superman\nSuperman: Secret Identity\nMister Miracle',
 '@cieItae the return of superman',
 "RT @Mister_Walsh: Watching Superman: The Movie as I draw today and it's got me itching for a new Supes movies that is full of hope and ligh…",
 'RT @DrPopCultureBG: Great Moments in Villainy\n\n#Superman https://t.co/c3kiDO213F',
 '@AdamTGorham @Mister_Walsh Frankly it’s the only parts of Snyder’s Superman I like. The flying scene in the arctic with soaring score. \n\nThen the rest happened.',
 'Great Moments in Villainy\n\n#Superman https://t.co/c3kiDO213F',
 'My superman T-shirt for for me on my birthday by my sweet little strawberry pie cup I love you dear https://t.co/GCrjm5nz69']
</code></pre></div></div>

<p>Next step was to clean the tweets, using the function ‘clean_tweets()’ and save cleaned tweets in variable ‘tweets_clean’.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tweets_clean</span><span class="o">=</span><span class="n">clean_tweets</span><span class="p">(</span><span class="n">tweets</span><span class="p">)</span>
<span class="n">tweets_clean</span>
</code></pre></div></div>

<p>The following cleaned tweets are shown.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[': The Best',
 'WATCHMENPERSEPOLISMAUSBATMAN YEAR ONEX-MEN GOD LOVES, MAN KILLSSECRET WARSIDENTITY CRISISBATMAN BLACK MIRRORSPIDER-MAN SAGA OF THE ALIEN COSTUMEALL-STAR SUPERMAN',
 'I chose Superman on purpose. His stories are usually uplifting and pretty positive. If you get a chance, the first story arc post Infinite Crisis (one year later) is amazing.',
 'Dark PheonixAll Star SupermanSuperman: Secret IdentityMister Miracle',
 'the return of superman',
 ": Watching Superman: The Movie as I draw today and it's got me itching for a new Supes movies that is full of hope and ligh",
 ': Great Moments in Villainy',
 'Frankly its the only parts of Snyders Superman I like. The flying scene in the arctic with soaring score. Then the rest happened.',
 'Great Moments in Villainy',
 'My superman T-shirt for for me on my birthday by my sweet little strawberry pie cup I love you dear']
</code></pre></div></div>

<p>Can you see the 9th tweet ‘Great Moments in Villainy’? What do you think of its classification, positive or negative? Let’s check how the function get_sentiment() classifies it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sentiment_scores</span> <span class="o">=</span> <span class="n">get_sentiment</span><span class="p">(</span><span class="n">tweets_clean</span><span class="p">)</span>
<span class="n">sentiment_scores</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1.0,
-0.20833333333333331,
0.17954545454545456,
-0.275,
0.0,
0.24318181818181817,
0.8,
0.0,
0.8,
0.22083333333333333]
</code></pre></div></div>

<p>The score goes from -1 (negative) to 1 (positive). That tells how each tweeter feel on the keyword ‘superman’. The 9th tweet ‘Great Moments in Villainy’ was scored 0.8, which means that the tweeter felt extremely positive on ‘superman’ at that time. However, (s)he actually talks about ‘villainy’, not ‘superman’. Now, we know that it is misclassified. Practice2 will show performance of sentiment analysis between TextBlob and NLTK Vader. I chose these two packages because they are fast and accurate enough for a tremendous amount of text data. If you interested in more details on performance comparison over Vader, IBM Watson, or TextBlob, check <a href="https://medium.com/@Intellica.AI/vader-ibm-watson-or-textblob-which-is-better-for-unsupervised-sentiment-analysis-db4143a39445">here</a>.</p>

<p>If you want to see the code, check <a href="">here</a></p>

<h1 id="practice2-twitter-streaming-and-visualizing-trump">Practice2: Twitter Streaming and Visualizing (Trump)</h1>
<p>Practice2 is to see how live twitters think about the keyword and we will compare performance of NLTK Vader and TextBlob. The program captures the real-time tweets related to the keyword that you can set up. In this time, let’s check how people think of President Trump (i.e. keyword=’Trump’).</p>

<p><img src="/assets/images/Data-Crawling-TwitterAPI/trump.png" alt="trump" height="800px" width="200px" /></p>

<h2 id="importing-1">Importing</h2>
<p>Similar to Practice1, I imported the necessary libraries and set the credentials (Consumer Key and Access Key).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span><span class="p">;</span> <span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s">'whitegrid'</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span><span class="p">,</span> <span class="n">STOPWORDS</span>
<span class="c1">## NLP operation on text
</span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="p">.</span><span class="n">download</span><span class="p">(</span><span class="s">'vader_lexicon'</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">nltk.sentiment.vader</span> <span class="kn">import</span> <span class="n">SentimentIntensityAnalyzer</span>
<span class="c1"># To consume Twitter's API
</span><span class="kn">import</span> <span class="nn">tweepy</span>
<span class="kn">from</span> <span class="nn">tweepy</span> <span class="kn">import</span> <span class="n">Stream</span>
<span class="kn">from</span> <span class="nn">tweepy</span> <span class="kn">import</span> <span class="n">StreamListener</span>
<span class="kn">from</span> <span class="nn">secrets</span> <span class="kn">import</span> <span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_secret</span><span class="p">,</span> <span class="n">access_key</span><span class="p">,</span> <span class="n">access_secret</span>
<span class="c1"># To identify the sentiment of text
</span><span class="kn">from</span> <span class="nn">textblob</span> <span class="kn">import</span> <span class="n">TextBlob</span>
<span class="kn">from</span> <span class="nn">textblob.sentiments</span> <span class="kn">import</span> <span class="n">NaiveBayesAnalyzer</span>
<span class="c1"># ignoring all the warnings
</span><span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">"ignore"</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="nb">DeprecationWarning</span><span class="p">)</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>
<p>I entered the keyword ‘trump’ to see what emotional tweets about President Trump the live twitters have.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'Which keyword you want to check on real-time twitter?'</span><span class="p">)</span>
<span class="n">KEYWORDS</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Which keyword you want to check on real-time twitter?

 Trump
</code></pre></div></div>

<p>Then, I defined the filename in the constant ‘OUTPUT_NAME’ added to ‘.csv’ to output a csv file. Since streaming goes forever unless you don’t command when to stop, a limit of 10 (value of the constant ‘THRESHOLD’ can be flexible depending on user).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># rename the output file.
</span><span class="n">OUTPUT_NAME</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">"AND | OR"</span><span class="p">,</span> <span class="s">"_"</span><span class="p">,</span> <span class="n">KEYWORDS</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'"'</span><span class="p">,</span><span class="s">""</span><span class="p">)).</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
<span class="n">OUTPUT_FILE</span> <span class="o">=</span> <span class="n">OUTPUT_NAME</span><span class="o">+</span><span class="s">".csv"</span>
<span class="c1"># number of tweets to capture.
</span><span class="n">THRESHOLD</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre></div></div>
<h2 id="streaming-and-saving-live-streaming-data">Streaming and Saving Live Streaming Data</h2>

<p>Now, the class <code class="language-plaintext highlighter-rouge">MyStreamListener()</code> was built to the tweet listener class. I customized the class to make it enable to inherit from the <code class="language-plaintext highlighter-rouge">tweepy.StreamListener</code>, count number of tweets it is currently storing to limit, and store it in a JSON format.</p>
<blockquote>
  <p>Whenever 10 tweets are saved, it prints to show it is working.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MyStreamListener</span><span class="p">(</span><span class="n">tweepy</span><span class="p">.</span><span class="n">StreamListener</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyStreamListener</span><span class="p">,</span> <span class="bp">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">num_tweets</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">OUTPUT_FILE</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="n">tweet</span> <span class="o">=</span> <span class="n">status</span><span class="p">.</span><span class="n">_json</span>
        <span class="bp">self</span><span class="p">.</span><span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">num_tweets</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Stops streaming when it reaches the limit
</span>        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">num_tweets</span> <span class="o">&lt;=</span> <span class="n">THRESHOLD</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">num_tweets</span> <span class="o">%</span><span class="mi">10</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Numbers of tweets caught so far: </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">num_tweets</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="p">.</span><span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Error detected"</span><span class="p">)</span>
</code></pre></div></div>

<p>The live tweets streaming was started after permission of accessing Twitter APIs by using Consumer and Access keys that authenticate the user. To grab the only tweets related to the keywords ‘trump’, <code class="language-plaintext highlighter-rouge">filter()</code> was set for the keyword ‘trump’ tracker and language (‘en’).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">auth</span> <span class="o">=</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">OAuthHandler</span><span class="p">(</span><span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_secret</span><span class="p">)</span>
<span class="n">auth</span><span class="p">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">access_secret</span><span class="p">)</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">API</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="n">wait_on_rate_limit</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">wait_on_rate_limit_notify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">tweets_listener</span> <span class="o">=</span> <span class="n">MyStreamListener</span><span class="p">()</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">api</span><span class="p">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">tweets_listener</span><span class="p">)</span>
<span class="n">stream</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">track</span><span class="o">=</span><span class="p">[</span><span class="n">KEYWORDS</span><span class="p">],</span> <span class="n">languages</span><span class="o">=</span><span class="p">[</span><span class="s">"en"</span><span class="p">])</span>
</code></pre></div></div>
<h2 id="loading-and-cleaning-the-data">Loading and Cleaning the Data</h2>
<p>The following code snippet is for loading the Twitter live data that saved in a JSON format.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Initialize empty list to store tweets
</span><span class="n">tweets_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Open connection to file
</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">OUTPUT_FILE</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">tweets_file</span><span class="p">:</span>
    <span class="c1"># Read in tweets and store in list
</span>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tweets_file</span><span class="p">:</span>
        <span class="n">tweet</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">tweets_data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">id_extractor()</code> is defined to extract the live user names who tweeted about the keyword ‘trump’ so that if you are interested in who wrote the tweet texts, you can search.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">id_extractor</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">name_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'user'</span><span class="p">][</span><span class="s">'screen_name'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>

<span class="n">user_names</span> <span class="o">=</span> <span class="n">id_extractor</span><span class="p">(</span><span class="n">tweets_data</span><span class="p">)</span>
<span class="n">user_names</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>DrRickF</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PauliePops1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TheRealAZJhawks</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PainterMom101</td>
    </tr>
    <tr>
      <th>4</th>
      <td>YouEndorse</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ICBubbleGum</td>
    </tr>
    <tr>
      <th>6</th>
      <td>tahitianspecial</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CrystalScurr</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Qnited_We_Stand</td>
    </tr>
    <tr>
      <th>9</th>
      <td>SassyP100</td>
    </tr>
    <tr>
      <th>10</th>
      <td>CynthiaMsnene</td>
    </tr>
  </tbody>
</table>
</div>

<p>The <code class="language-plaintext highlighter-rouge">clean_tweet()</code> is defined to clean a tweet text by removing special characters so that NLP packages like TextBlob or NLTK Vader can read it corrextly.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">clean_tweet</span><span class="p">(</span><span class="n">tweet</span><span class="p">):</span>
        <span class="s">'''
        To clean tweet text by removing special characters
        '''</span>
        <span class="n">cleaned_tweet</span> <span class="o">=</span> <span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">"(@[A-Za-z0-9]+) | ([^0-9A-Za-z </span><span class="se">\t</span><span class="s">]) | (\w+:\/\/\S+)"</span><span class="p">,</span>
                                        <span class="s">" "</span><span class="p">,</span> <span class="n">tweet</span><span class="p">).</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">cleaned_tweet</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">full_text_extractor()</code> is defined to extract a full tweet text. Remember the saved file is in a JSON format; mixture of list and dictionary. I grabbed created date (created_at), language (lang), tweet text (text), and user’s name (user_name). If contents of a tweet text is longer, such tweet texts are cut off. Thus, the <code class="language-plaintext highlighter-rouge">full_text_extractor()</code> can snatch them for you.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">full_text_extractor</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="s">'''
    To extract full text from each user.
    '''</span>
    <span class="n">full_text_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="c1"># if there is 'extended_tweet', clean the full_text and append it to the full_text_list.
</span>        <span class="k">if</span> <span class="n">tweets_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">__contains__</span><span class="p">(</span><span class="s">'extended_tweet'</span><span class="p">):</span>
            <span class="n">full_text_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_tweet</span><span class="p">(</span><span class="n">tweets_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'extended_tweet'</span><span class="p">][</span><span class="s">'full_text'</span><span class="p">]))</span>
        <span class="c1"># if there is 'retweeted_status' and extended_tweet in it, clean the full_text and  
</span>        <span class="c1"># append it to the full_text_list. Otherwise, clean and append the text.
</span>        <span class="k">elif</span> <span class="n">tweets_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">__contains__</span><span class="p">(</span><span class="s">'retweeted_status'</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">tweets_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'retweeted_status'</span><span class="p">].</span><span class="n">__contains__</span><span class="p">(</span><span class="s">'extended_tweet'</span><span class="p">):</span>
                <span class="n">full_text_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_tweet</span><span class="p">(</span><span class="n">clean_tweet</span><span class="p">(</span><span class="n">tweets_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'retweeted_status'</span><span class="p">][</span><span class="s">'extended_tweet'</span><span class="p">][</span><span class="s">'full_text'</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">full_text_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_tweet</span><span class="p">(</span><span class="n">clean_tweet</span><span class="p">(</span><span class="n">tweets_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'text'</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">full_text_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_tweet</span><span class="p">(</span><span class="n">tweets_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'text'</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">full_text_list</span><span class="p">)</span>
</code></pre></div></div>

<p>The following shows the full texts of the ‘trump’ that the <code class="language-plaintext highlighter-rouge">full_text_extractor()</code> snatched.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># To check what the full_texts is.
</span><span class="n">full_texts</span><span class="o">=</span><span class="n">full_text_extractor</span><span class="p">(</span><span class="n">tweets_data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">full_texts</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                                    0
0   Speaking of yard signs- i’ve been seeing Trump...
1   RT @catturd2: President Trump owned the Democr...
2   Every single eligible American should have the...
3   From a friend: An anguished question from a Tr...
4   RT @TheOnion: Trump Slaughters Dozens Of Ameri...
5   RT @TweetSusieTweet: Trump on Mount Rushmore. ...
6   Trump is about to cut out the middlemen in pha...
7                                  No matter what YES
8   RT @RealBrysonGray: Keep sharing this to make ...
9   RT @RyanAFournier: Trump: Authorizes $430 mill...
10  RT @thekjohnston: This is why trump built appr...
</code></pre></div></div>

<p>From the selective columns of created date (created_at), language (lang), tweet text (text), and user’s name (user_name), I replaced the cut-off tweet texts with the full texts and inserted user_name column and its corresponding values. The <code class="language-plaintext highlighter-rouge">df.text[5]</code> shows its full text.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tweets_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'created_at'</span><span class="p">,</span><span class="s">'lang'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">])</span>
<span class="c1"># store user names
</span><span class="n">df</span><span class="p">[</span><span class="s">'user_name'</span><span class="p">]</span><span class="o">=</span><span class="n">user_names</span>
<span class="c1"># replace texts with full texts if there is any
</span><span class="n">df</span><span class="p">[</span><span class="s">'text'</span><span class="p">]</span><span class="o">=</span><span class="n">full_texts</span>
<span class="c1"># convert to datetime
</span><span class="n">df</span><span class="p">[</span><span class="s">'created_at'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'RT @TweetSusieTweet: Trump on Mount Rushmore. Cheers from Australia! Credit: @moir_alan'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>11

&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;created_at&lt;/th&gt;
      &lt;th&gt;lang&lt;/th&gt;
      &lt;th&gt;text&lt;/th&gt;
      &lt;th&gt;user_name&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2020-08-10 06:57:25+00:00&lt;/td&gt;
      &lt;td&gt;en&lt;/td&gt;
      &lt;td&gt;Speaking of yard signs- i’ve been seeing Trump...&lt;/td&gt;
      &lt;td&gt;DrRickF&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2020-08-10 06:57:25+00:00&lt;/td&gt;
      &lt;td&gt;en&lt;/td&gt;
      &lt;td&gt;RT @catturd2: President Trump owned the Democr...&lt;/td&gt;
      &lt;td&gt;PauliePops1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2020-08-10 06:57:25+00:00&lt;/td&gt;
      &lt;td&gt;en&lt;/td&gt;
      &lt;td&gt;Every single eligible American should have the...&lt;/td&gt;
      &lt;td&gt;TheRealAZJhawks&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">textblob_analyzer()</code> is defined to classify a tweet into three categories of emotions: positive, negative, or neutral to identify the tweeters’ sentiments toward the keyword ‘trump’.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">textblob_analyzer</span><span class="p">(</span><span class="n">tweet</span><span class="p">):</span>
        <span class="s">'''
        To classify sentiment positive, negative, or neutral  
        '''</span>
        <span class="c1"># create TextBlob object of passed tweet text
</span>        <span class="n">analysis</span> <span class="o">=</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>

        <span class="c1"># set sentiment
</span>        <span class="k">if</span> <span class="n">analysis</span><span class="p">.</span><span class="n">sentiment</span><span class="p">.</span><span class="n">polarity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">'positive'</span>
        <span class="k">elif</span> <span class="n">analysis</span><span class="p">.</span><span class="n">sentiment</span><span class="p">.</span><span class="n">polarity</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">'negative'</span>
        <span class="k">elif</span> <span class="n">analysis</span><span class="p">.</span><span class="n">sentiment</span><span class="p">.</span><span class="n">polarity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">'neutral'</span>
</code></pre></div></div>
<p>Similarly, the <code class="language-plaintext highlighter-rouge">vader_analyzer()</code> is defined to compare its performance with TextBlob. The neutrality condition is if score is between -0.05 and 0.05 (i.e. \(-0.5 \leq \text{score} \leq 0.5\)).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sid</span> <span class="o">=</span> <span class="n">SentimentIntensityAnalyzer</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">get_vader_score</span><span class="p">(</span><span class="n">tweet</span><span class="p">):</span>
    <span class="c1"># Polarity score returns dictionary
</span>    <span class="n">score</span> <span class="o">=</span> <span class="n">sid</span><span class="p">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">score</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">vader_analyzer</span><span class="p">(</span><span class="n">tweet</span><span class="p">):</span>
        <span class="s">'''
        To classify sentiment positive, negative, or neutral  
        '''</span>
        <span class="c1"># create TextBlob object of passed tweet text  
</span>        <span class="n">score</span> <span class="o">=</span> <span class="n">get_vader_score</span><span class="p">(</span><span class="n">tweet</span><span class="p">)[</span><span class="s">'compound'</span><span class="p">]</span>

        <span class="c1"># set sentiment
</span>        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mf">0.05</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">'positive'</span>
        <span class="k">elif</span> <span class="n">score</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">'negative'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">'neutral'</span>
</code></pre></div></div>

<p>Both functions are applied to the ‘text’ column in the dataframe ‘df’ and results were added to new columns ‘TextBlob’ and ‘Vader’.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># See how the df looks.
</span><span class="n">df</span><span class="p">[</span><span class="s">'TextBlob'</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'text'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tweet</span><span class="p">:</span> <span class="n">textblob_analyzer</span><span class="p">(</span><span class="n">tweet</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s">'Vader'</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'text'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tweet</span><span class="p">:</span> <span class="n">vader_analyzer</span><span class="p">(</span><span class="n">tweet</span><span class="p">))</span>
<span class="n">df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>lang</th>
      <th>text</th>
      <th>user_name</th>
      <th>TextBlob</th>
      <th>Vader</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>Speaking of yard signs- i’ve been seeing Trump...</td>
      <td>DrRickF</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @catturd2: President Trump owned the Democr...</td>
      <td>PauliePops1</td>
      <td>positive</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>Every single eligible American should have the...</td>
      <td>TheRealAZJhawks</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>From a friend: An anguished question from a Tr...</td>
      <td>PainterMom101</td>
      <td>negative</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @TheOnion: Trump Slaughters Dozens Of Ameri...</td>
      <td>YouEndorse</td>
      <td>neutral</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @TweetSusieTweet: Trump on Mount Rushmore. ...</td>
      <td>ICBubbleGum</td>
      <td>neutral</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>Trump is about to cut out the middlemen in pha...</td>
      <td>tahitianspecial</td>
      <td>positive</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>No matter what YES</td>
      <td>CrystalScurr</td>
      <td>neutral</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @RealBrysonGray: Keep sharing this to make ...</td>
      <td>Qnited_We_Stand</td>
      <td>negative</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @RyanAFournier: Trump: Authorizes $430 mill...</td>
      <td>SassyP100</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @thekjohnston: This is why trump built appr...</td>
      <td>CynthiaMsnene</td>
      <td>neutral</td>
      <td>neutral</td>
    </tr>
  </tbody>
</table>
</div>

<p>The following code snippet is to grab the classified values. Those if conditions are in the case that a value for any of group can be zero.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Two analysis
</span><span class="n">textBlob_results</span><span class="o">=</span><span class="n">df</span><span class="p">.</span><span class="n">TextBlob</span><span class="p">.</span><span class="n">value_counts</span><span class="p">().</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">if</span> <span class="n">Cond_TextBlob</span><span class="p">:</span>
    <span class="n">textBlob_results</span><span class="p">[</span><span class="s">'positive'</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'TextBlob'</span><span class="p">]</span><span class="o">==</span><span class="s">'positive'</span><span class="p">).</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">textBlob_results</span><span class="p">[</span><span class="s">'neutral'</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'TextBlob'</span><span class="p">]</span><span class="o">==</span><span class="s">'neutral'</span><span class="p">).</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">textBlob_results</span><span class="p">[</span><span class="s">'negative'</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'TextBlob'</span><span class="p">]</span><span class="o">==</span><span class="s">'negative'</span><span class="p">).</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>

<span class="n">Vader_results</span><span class="o">=</span><span class="n">df</span><span class="p">.</span><span class="n">Vader</span><span class="p">.</span><span class="n">value_counts</span><span class="p">().</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">Cond_Vader</span><span class="o">=</span> <span class="p">(</span><span class="n">Vader_results</span><span class="p">.</span><span class="n">positive</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Vader_results</span><span class="p">.</span><span class="n">neutral</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Vader_results</span><span class="p">.</span><span class="n">negative</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">if</span> <span class="n">Cond_Vader</span><span class="p">:</span>
    <span class="n">Vader_results</span><span class="p">[</span><span class="s">'positive'</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'Vader'</span><span class="p">]</span><span class="o">==</span><span class="s">'positive'</span><span class="p">).</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">Vader_results</span><span class="p">[</span><span class="s">'neutral'</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'Vader'</span><span class="p">]</span><span class="o">==</span><span class="s">'neutral'</span><span class="p">).</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">Vader_results</span><span class="p">[</span><span class="s">'negative'</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'Vader'</span><span class="p">]</span><span class="o">==</span><span class="s">'negative'</span><span class="p">).</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>
<p>Here, you can see the values for each group.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">textBlob_results</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>positive    4
neutral     4
negative    3
Name: TextBlob, dtype: int64 ```python Vader_results ```
positive    7
neutral     1
negative    3
Name: Vader, dtype: int64
</code></pre></div></div>

<p>Pie plot is used to compare the performance of both TextBlob and Vader.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot Pie plot.
</span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s">'positive'</span><span class="p">,</span><span class="s">'neutral'</span><span class="p">,</span><span class="s">'negative'</span><span class="p">]</span>
    <span class="n">colors_emotion</span> <span class="o">=</span> <span class="p">[</span><span class="s">'cyan'</span><span class="p">,</span><span class="s">'yellow'</span><span class="p">,</span><span class="s">'tomato'</span><span class="p">]</span>
    <span class="n">explodes_emotion</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#axis 1 for TextBlob analyzer
</span>    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">pie</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">textBlob_results</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="n">label_list</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">colors_emotion</span><span class="p">,</span><span class="n">explode</span><span class="o">=</span><span class="n">explodes_emotion</span><span class="p">,</span>
            <span class="n">autopct</span><span class="o">=</span><span class="s">'%1.1f%%'</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s">'TextBlob Analyzer on </span><span class="si">{</span><span class="n">KEYWORDS</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
    <span class="c1">#axis 2 for Vader analyzer
</span>    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">pie</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Vader_results</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="n">label_list</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">colors_emotion</span><span class="p">,</span><span class="n">explode</span><span class="o">=</span><span class="n">explodes_emotion</span><span class="p">,</span>
            <span class="n">autopct</span><span class="o">=</span><span class="s">'%1.1f%%'</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s">'Vader Analyzer on </span><span class="si">{</span><span class="n">KEYWORDS</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/Data-Crawling-TwitterAPI/output_22_0.png" alt="Comparison" height="800px" width="650px" /><br />
| Fig3. Comparison between TextBlob and Vader|</p>

<p>Let’s group the data into three, based on Vader, and check some samples if they are reasonably classified.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Group the people who have the similar opinions on
# keyword.
</span><span class="n">pos_group</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Vader'</span><span class="p">]</span><span class="o">==</span><span class="s">'positive'</span><span class="p">]</span>
<span class="n">neg_group</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Vader'</span><span class="p">]</span><span class="o">==</span><span class="s">'negative'</span><span class="p">]</span>
<span class="n">neut_group</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Vader'</span><span class="p">]</span><span class="o">==</span><span class="s">'neutral'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pos_group</span>
</code></pre></div></div>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>lang</th>
      <th>text</th>
      <th>user_name</th>
      <th>TextBlob</th>
      <th>Vader</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>Speaking of yard signs- i’ve been seeing Trump...</td>
      <td>DrRickF</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>Every single eligible American should have the...</td>
      <td>TheRealAZJhawks</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>From a friend: An anguished question from a Tr...</td>
      <td>PainterMom101</td>
      <td>negative</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @TheOnion: Trump Slaughters Dozens Of Ameri...</td>
      <td>YouEndorse</td>
      <td>neutral</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @TweetSusieTweet: Trump on Mount Rushmore. ...</td>
      <td>ICBubbleGum</td>
      <td>neutral</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>No matter what YES</td>
      <td>CrystalScurr</td>
      <td>neutral</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @RealBrysonGray: Keep sharing this to make ...</td>
      <td>Qnited_We_Stand</td>
      <td>negative</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>

<p>Check a tweet text sample in the positive group, which seems more like neutral rather than positive.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Check a text in the positive group
</span><span class="n">pos_group</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"Every single eligible American should have the opportunity to vote-by-mail this November. If it's good enough for Donald Trump then it's good enough for you and me."
</code></pre></div></div>

<p>I measured scores and process time, using the functions shown below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Vstart</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Vader: </span><span class="si">{</span><span class="n">get_vader_score</span><span class="p">(</span><span class="n">pos_group</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">Vend</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'vs'</span><span class="p">)</span>
<span class="n">Tstart</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'TextBlob: </span><span class="si">{</span><span class="n">TextBlob</span><span class="p">(</span><span class="n">pos_group</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">]).</span><span class="n">sentiment</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">Tend</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'vs'</span><span class="p">)</span>
<span class="n">Nstart</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'TextBlob w/ NB: </span><span class="si">{</span><span class="n">TextBlob</span><span class="p">(</span><span class="n">pos_group</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">analyzer</span><span class="o">=</span><span class="n">NaiveBayesAnalyzer</span><span class="p">()).</span><span class="n">sentiment</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">Nend</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Vader: {'neg': 0.0, 'neu': 0.736, 'pos': 0.264, 'compound': 0.8225}
vs
TextBlob: Sentiment(polarity=0.22142857142857142, subjectivity=0.40238095238095245)
vs
TextBlob w/ NB: Sentiment(classification='pos', p_pos=0.7772960377509671, p_neg=0.22270396224903263)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Vader: </span><span class="si">{</span><span class="n">Vend</span><span class="o">-</span><span class="n">Vstart</span><span class="si">}</span><span class="s"> s, TextBlob: </span><span class="si">{</span><span class="n">Tend</span><span class="o">-</span><span class="n">Tstart</span><span class="si">}</span><span class="s"> s, TextBlob: </span><span class="si">{</span><span class="n">Nend</span><span class="o">-</span><span class="n">Nstart</span><span class="si">}</span><span class="s"> s'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Vader: 0.0016090869903564453 s, TextBlob: 0.0011258125305175781 s, TextBlob: 4.698314905166626 s
</code></pre></div></div>

<p>The tweet text sample is classified positive for all the cases, but scores are different. If neutrality condition is differently set up, Vader can be better. Moreover, despite the duration TextBlob without NB is the fastest, Vader is useful for the sentiment analysis tasks like movie reviews or book reviews.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">neg_group</span><span class="p">.</span><span class="n">text</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>lang</th>
      <th>text</th>
      <th>user_name</th>
      <th>TextBlob</th>
      <th>Vader</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @catturd2: President Trump owned the Democr...</td>
      <td>PauliePops1</td>
      <td>positive</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>Trump is about to cut out the middlemen in pha...</td>
      <td>tahitianspecial</td>
      <td>positive</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020-08-10 06:57:25+00:00</td>
      <td>en</td>
      <td>RT @RyanAFournier: Trump: Authorizes $430 mill...</td>
      <td>SassyP100</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
  </tbody>
</table>
</div>

<p>The tweet text samples from the negative group. The text can be neutral or negative. Vader seems better for analysis.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">words</span><span class="o">=</span><span class="n">neg_group</span><span class="p">.</span><span class="n">text</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="n">words</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'Trump is about to cut out the middlemen in pharmaceutical markets. This is huge Right after announcing that, he says “So I have a lot of enemies out there, this may be the last time you see me for awhile.” Is he saying big pharma is plotting to kill him?'
</code></pre></div></div>

<p>Let’s look at what the user of this guys who wrote above think, using the <code class="language-plaintext highlighter-rouge">wordcloud</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">STOPWORDS</span><span class="p">)</span> <span class="c1"># pre-defined words to ignore
# adding extra words to ignore:
# many tweets contain RT in the text, and we know the tweets are about Donald Trump
</span><span class="n">stopwords</span><span class="p">.</span><span class="n">update</span><span class="p">([</span><span class="n">KEYWORDS</span><span class="p">])</span>
<span class="n">wordcloud</span> <span class="o">=</span> <span class="p">(</span><span class="n">WordCloud</span><span class="p">(</span><span class="n">background_color</span><span class="o">=</span><span class="s">"white"</span><span class="p">,</span> <span class="c1"># easier to read
</span>                      <span class="n">max_words</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="c1"># let's no polute it too much
</span>                      <span class="n">stopwords</span><span class="o">=</span><span class="n">stopwords</span><span class="p">)</span> <span class="c1"># define words to ignore
</span>                      <span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="n">words</span><span class="p">))</span> <span class="c1"># generate the wordcloud with text
</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># make the plot bigger
# Show the plot (interpolation='bilinear' makes it better looking)
</span><span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">'bilinear'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">"off"</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="/assets/images/Data-Crawling-TwitterAPI/output_33_1.png" alt="Wordcloud" height="800px" width="650px" /><br />
| Fig4. Wordcloud of a specific Twitter User about Trump|</p>

<p>Likewise, you can use any cases to know what people think and contact them via Twitter, changing ‘KEYWORDS’ and ‘THRESHOLD’.</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#web" class="page__taxonomy-item" rel="tag">web</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-08-09T00:00:00+01:00">August 09, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Data+Crawling+with+Twitter+API%20http%3A%2F%2Flocalhost%3A4000%2FData-Crawling-TwitterAPI%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FData-Crawling-TwitterAPI%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2FData-Crawling-TwitterAPI%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/api/" class="pagination--pager" title="Into. to APIs and Web
">Previous</a>
    
    
      <a href="/Data-Crawling-Scrapy/" class="pagination--pager" title="Data Crawling with Scrapy
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/" rel="permalink">Deep Learning Applications in Computer Vision
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Deep Learning / Computer Vision /
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/cv_intro/" rel="permalink">Deep Learning Applications in Computer Vision
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Deep Learning / Computer Vision /
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Backpropagation/" rel="permalink">Deep Learning Performance Improvement 4 - Back-propagation
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  16 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Back-propagation / Forward-propagation /  Machine Learning Performance Improvement
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Regularization/" rel="permalink">Deep Learning Performance Improvement 3 - Regularization
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  21 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Penalizing Regularization (L1 and L2) / Dropout /  Machine Learning Performance Improvement
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://www.linkedin.com/in/jaechoi2357/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/pnut2357" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Jae H. Choi. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/Data-Crawling-TwitterAPI/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/Data-Crawling-TwitterAPI"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://JBlog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>
